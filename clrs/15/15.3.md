## 15.3-2 Why Mergesort can't be sped up with DP?

See [Discussion](https://github.com/walkccc/CLRS/issues/122)

Example:

```
4 3 2 1 4 3 2 1 4 3 2 1 4 3 2 1
4 3 2 1 4 3 2 1 ...
4 3 2 1  4 3 2 1 ...
4 3  2 1  4 3 2 1 ...
3 4  1 2  4 3 2 1 ...
1 2 3 4  4 3 2 1 (memoization) ... 
1 2 3 4  1 2 3 4 ...
1 1 2 2 3 3 4 4  4 3 2 1 4 3 2 1 (memoization)
1 1 2 2 3 3 4 4  1 1 2 2 3 3 4 4
1 1 1 1 2 2 2 2 3 3 3 3 4 4 4 4 

```

Problem, memoization. How to store solutions to previously solved? How to compute hash? Key storage: O(n), value: O(n). Compute hash time: O(n). It needs to iterate subproblem elements before solving it recursively to determine that the same problem solved before. Space proposonal to $(n+nlog(n))$. 


## 15.3-3

> Consider a variant of the matrix-chain multiplication problem in which the goal is to parenthesize the sequence of matrices so as to maximize, rather than minimize, the number of scalar multiplications. Does this problem exhibit optimal substructure?

Yes, because optimal solution will consist of optimal solutions to subproblems, i.e. $$m[i,j] = max \left\{ m[i,k] + p_{i-1} p_j p_k + m[k+1,j] \right\} $$ for $k = i,..,j-1$


## 15.3-4

> Can we find an optimal solution without solving subproblems before by choosing k with min $p_{i-1} p_k p_j$ ? Contra-example?

Example: 
$A_1, A_2, A_3, A_4 = 1000,100,20,10,1000$ 

Greedy: $((A_1 A_2)A_3)A_4$. Total calculations = 1220e4.

DP: $(A_1 (A_2A_3))A_4$. Total: 1102e4.


## 15.3-5

> Suppose that in the rod-cutting problem of Section 15.1, we also had limit $l_i$ on the number of pieces of length i that we are allowed to produce, for i = 1,2,..,n. Show that the optimal-substructure property described in Section 15.1 no longer holds.

$l_i$ - number of pieces of length i. Equation, $$r_{n} = max \left\{ r_{n-k} + p_{k} \right\} $$ for k in 1..n, does not hold. 

Example.
$p_i$ price for length of i:

1  | 2 | 3 |
---|---|---|
10 | 2 | 2 |

$$r_1 = max \left\{ p_1 = 10 \right\}$$
$$r_2 = max \left\{ p_2 = 2, r_1+p_1 = 10+10 \right\}$$
$$r_3 = max \left\{ p_3 = 2, r_1+p_2 = 10+2, r_2+p_1 = 10+10+10 \right\}$$

For $$l_3, l_2, l_1 = 2$$, no optimal independent substructure as $$r_3 \neq r_2 + p_1 $$ because it over the $l_3$. So optimal solution for $r_3$ (12) is not composed from optimal subsolutions ($r_2$) as it depends on $l_3$ so subproblems are not independant.


## 15.3-6

> Imagine that you wish to exchange one currency for another. You realize that instead of directly exchanging one currency for another, you might be better off making a series of trades through other currencies, winding up with the currency you want. Suppose that you can trade $n$ different currencies, numbered $1, 2, \ldots, n$, where you start with currency $1$ and wish to wind up with currency $n$. You are given, for each pair of currencies $i$ and $j$ , an exchange rate $r_{ij}$, meaning that if you start with $d$ units of currency $i$ , you can trade for $dr_{ij}$ units of currency $j$. A sequence of trades may entail a commission, which depends on the number of trades you make. Let $c_k$ be the commission that you are charged when you make $k$ trades. Show that, if $c_k = 0$ for all $k = 1, 2, \ldots, n$, then the problem of finding the best sequence of exchanges from currency $1$ to currency $n$ exhibits optimal substructure. Then show that if commissions $c_k$ are arbitrary values, then the problem of finding the best sequence of exchanges from currency $1$ to currency $n$ does not necessarily exhibit optimal substructure.

**Case 1** $c_k = 0$. 1,2,3,..,n currencies. $r_{ij}$ exchange rate. Best seq. of exchanges from 1 to n? 

Assume that we can't exchange to the same currency twice (or else we can do cycles infinitely and get infinitely large amount). Let $u_i$ be units of currency $i$ traded from $d$ units of currency $i$ using the best sequence and $u_1 = d$. Then $$u_i = min \left\{ u_{j} r_{ji}  \text{ for } j=2 \ldots n-1 \right\} $$ for i=1..n. Then $u_n$ is the units of currency $n$ given the best sequence. It exposes optimal substructure as each $u_i$ is based on optimal sequence to get units in $i$ currency. Think a shortest path problem.

**Case 2** When $c_k \gt 0$ it is not optimal substructure.

Example. Exchange rates:

 $r_{ij}$ | 1   | 2    | 3  |
----------|-----|------|----|
 1        | 1   | 1    | 6  |
 2        | 1   | 1    | 10 |
 3        | 1/6 | 1/10 | 1  |

c_1 = 0
c_2 = 5

1 > 2 > 3 = (1*1 - 0)*10 - 5 = 5
1 > 3 = 1*6 - 0 = 6
But if c_k = 1: 1 > 2 > 3 = 10. So it does not exposes substructure as optimal solution to k-th currency does not form optimal solution to n-th currency.
